<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>  五街道ルートマップ</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.0/dist/leaflet.css" />
  <link rel="stylesheet" href="style.css">

  <script src="https://unpkg.com/leaflet@1.3.0/dist/leaflet.js"></script>
  <script src="tokaido.js"></script>
  <script src="nakasendo.js"></script>
  <script src="nikkodoutyu.js"></script>
  <script src="kousyudoutyu.js"></script>
  <script src="ousyudoutyu.js"></script>
  
  <script>
    function init() {
      var map = L.map('mapcontainer', { zoomControl: false });
      var mpoint = [36.0,137.75];
      map.setView(mpoint, 7);

      //地理院タイル
      var gsi = L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png', {
        attribution: "<a href='https://maps.gsi.go.jp/development/ichiran.html' target='_blank'>地理院タイル</a>"
      });
      //淡色地図
      var gsipale = L.tileLayer('http://cyberjapandata.gsi.go.jp/xyz/pale/{z}/{x}/{y}.png', {
        attribution: "<a href='https://maps.gsi.go.jp/development/ichiran.html' target='_blank'>地理院タイル</a>"
      });
      //白地図
      var gsiblank = L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/blank/{z}/{x}/{y}.png', {
        attribution: "<a href='https://maps.gsi.go.jp/development/ichiran.html' target='_blank'>地理院タイル</a>"
      });
      //色別標高図
      var gsicol = L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/relief/{z}/{x}/{y}.png', {
        attribution: "<a href='https://maps.gsi.go.jp/development/ichiran.html' target='_blank'>地理院タイル</a>"
      });
      //地理院写真
      var gsiaerial = L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/seamlessphoto/{z}/{x}/{y}.jpg', {
        attribution: "<a href='https://maps.gsi.go.jp/development/ichiran.html' target='_blank'>地理院タイル</a>"
      });
      //オープンストリートマップ
      var osm = L.tileLayer('http://tile.openstreetmap.jp/{z}/{x}/{y}.png', {
        attribution: "<a href='http://osm.org/copyright' target='_blank'>OpenStreetMap</a> contributors"
      });

      L.control.scale({ maxWidth: 200, position: 'bottomright', imperial: false }).addTo(map);
      L.control.zoom({ position: 'bottomleft' }).addTo(map);

      var baseMaps = {
        "地理院地図" : gsi,
        "淡色地図" : gsipale,
        "白地図" : gsiblank,
        "色別標高図" : gsicol,
        "地理院写真" : gsiaerial,
        "オープンストリートマップ" : osm,
      };

      L.control.layers(baseMaps).addTo(map);
      // 初期表示レイヤー
      gsi.addTo(map);

      var myIcon1 = L.divIcon({ className: 'icon1', iconAnchor: [10, 10] });
      var myIcon2 = L.divIcon({ className: 'icon2', iconAnchor: [10, 10] });
      var myIcon3 = L.divIcon({ className: 'icon3', iconAnchor: [10, 10] });
      var myIcon4 = L.divIcon({ className: 'icon4', iconAnchor: [10, 10] });
      var myIcon5 = L.divIcon({ className: 'icon5', iconAnchor: [10, 10] });

      var tokaidoLayer = L.layerGroup();
      var nakasendoLayer = L.layerGroup();
      var nikkoudoutyuLayer = L.layerGroup();
      var ousyudoutyuLayer = L.layerGroup();
      var kousyudoutyuLayer = L.layerGroup();
      var tokaidoRouteLayer = L.layerGroup();
      var nakasendoRouteLayer = L.layerGroup();
      var nikkouRouteLayer = L.layerGroup();
      var ousyuRouteLayer = L.layerGroup();
      var kousyuRouteLayer = L.layerGroup();

      tokaido.forEach(function(s) {
      var popup1 = L.popup().setContent(s.name + "です");
      L.marker([s.lat, s.lng], { icon: myIcon1 }).bindPopup(popup1).bindTooltip(s.name).addTo(tokaidoLayer);});

      nakasendo.forEach(function(s){
        var popup2 = L.popup().setContent(s.name + "です");
        L.marker([s.lat, s.lng],{ icon: myIcon2 }).bindPopup(popup2).bindTooltip(s.name).addTo(nakasendoLayer);});
      
      nikkoudoutyu.forEach(function(s){
        var popup3 = L.popup().setContent(s.name + "です");
      L.marker([s.lat, s.lng], { icon: myIcon3 }).bindPopup(popup3).bindTooltip(s.name).addTo(nikkoudoutyuLayer)});

      ousyudoutyu.forEach(function(s){
        var popup4 = L.popup().setContent(s.name + "です");
      L.marker([s.lat, s.lng], { icon: myIcon4 }).bindPopup(popup4).bindTooltip(s.name).addTo(ousyudoutyuLayer)});

      kousyudoutyu.forEach(function(s){
        var popup5 = L.popup().setContent(s.name + "です");
      L.marker([s.lat, s.lng], { icon: myIcon5 }).bindPopup(popup5).bindTooltip(s.name).addTo(kousyudoutyuLayer)});

    var overlay = {
      "◆宿場": L.layerGroup(),
      "東海道": tokaidoLayer,
      "中山道": nakasendoLayer,
      "日光道中": nikkoudoutyuLayer,
      "奥州道中": ousyudoutyuLayer,
      "甲州道中": kousyudoutyuLayer,

      "◆ルート": L.layerGroup(),
      "東海道(ルート)": tokaidoRouteLayer,
      "中山道(ルート)": nakasendoRouteLayer,
    };
      var overlayControl = L.control.layers(null, overlay,{collapsed: false}).addTo(map);
      tokaidoLayer.addTo(map);
      nakasendoLayer.addTo(map);
      nikkoudoutyuLayer.addTo(map);
      ousyudoutyuLayer.addTo(map);
      kousyudoutyuLayer.addTo(map);

      setTimeout(function() {
        var container = overlayControl.getContainer();
        var labels = container.querySelectorAll('.leaflet-control-layers-selector + span');

        labels.forEach(function(span) {
        var text = span.textContent.trim();

      if (text.includes("東海道")) {
        span.classList.add('tokaido-label');
      }
      if (text.includes("中山道")) {
        span.classList.add('nakasendo-label');
      }
      if (text.includes("日光道中")) {
        span.classList.add('nikkou-label');
      }
      if (text.includes("奥州道中")) {
        span.classList.add('ousyu-label');
      }
      if(text.includes("甲州道中")){
        span.classList.add('kousyu-label');
      }
    });
    }, 10);
//東海道ルート
  fetch("tokaido1.geojson")
  .then(r => r.json())
  .then(data => {
    L.geoJSON(data, { color: "blue", weight: 5 }).addTo(tokaidoRouteLayer);
  });

  fetch("tokaido2.geojson")
  .then(r => r.json())
  .then(data => {
    L.geoJSON(data, { color: "blue", weight: 5}).addTo(tokaidoRouteLayer);
  });

  fetch("tokaido3.geojson")
  .then(r => r.json())
  .then(data => {
    L.geoJSON(data, { color: "blue", weight: 5}).addTo(tokaidoRouteLayer);
  });

  fetch("tokaido4.geojson")
  .then(r => r.json())
  .then(data => {
    L.geoJSON(data, { color: "blue", weight: 5}).addTo(tokaidoRouteLayer);
  });

  fetch("tokaido5.geojson")
  .then(r => r.json())
  .then(data => {
    L.geoJSON(data, { color: "blue", weight: 5}).addTo(tokaidoRouteLayer);
  });
//中山道ルート
  fetch("nakasendo1.geojson")
  .then(r => r.json())
  .then(data => {
    L.geoJSON(data, { color: "#FF4F02", weight: 5}).addTo(nakasendoRouteLayer);
  });
    fetch("nakasendo2.geojson")
  .then(r => r.json())
  .then(data => {
    L.geoJSON(data, { color: "#FF4F02", weight: 5}).addTo(nakasendoRouteLayer);
  });
    fetch("nakasendo3.geojson")
  .then(r => r.json())
  .then(data => {
    L.geoJSON(data, { color: "#FF4F02", weight: 5}).addTo(nakasendoRouteLayer);
  });
    fetch("nakasendo4.geojson")
  .then(r => r.json())
  .then(data => {
    L.geoJSON(data, { color: "#FF4F02", weight: 5}).addTo(nakasendoRouteLayer);
  });
    fetch("nakasendo5.geojson")
  .then(r => r.json())
  .then(data => {
    L.geoJSON(data, { color: "#FF4F02", weight: 5}).addTo(nakasendoRouteLayer);
  });
    fetch("nakasendo6.geojson")
  .then(r => r.json())
  .then(data => {
    L.geoJSON(data, { color: "#FF4F02", weight: 5}).addTo(nakasendoRouteLayer);
  });
    fetch("nakasendo7.geojson")
  .then(r => r.json())
  .then(data => {
    L.geoJSON(data, { color: "#FF4F02", weight: 5}).addTo(nakasendoRouteLayer);
  });
    }
  </script>
</head>
<body onload="init()">
  <div id="mapcontainer" style="position:absolute;top:0;left:0;right:0;bottom:0;"></div>

<div id="credit" style="
  position: absolute;
  bottom: 0px;
  right: 130px;
  background: rgba(255,255,255,0.8);
  padding: 1px 4px;
  border-radius: 4px;
  font-size: 12px;
  z-index: 9999;
">
  <a href="caution.html" target="_blank">利用上の注意</a>
</div>
</div>
</body>
</html>